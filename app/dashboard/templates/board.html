{% comment %}
  Copyright (C) 2019 Gitcoin Core

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published
  by the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  GNU Affero General Public License for more details.

  You should have received a copy of the GNU Affero General Public License
  along with this program. If not,see
  <http://www.gnu.org/licenses/>.
{% endcomment %}
{% load i18n static add_url_schema avatar_tags %}

<!DOCTYPE html>
<html lang="en">
  <head>
    {% include 'shared/head.html' %}
    {% include 'shared/cards.html' %}
    <link rel="stylesheet" href="{% static "v2/css/board.css" %}" />

  </head>
  <body class="{{ active }} bg-lightblue g-font-muli" >
    {% include 'shared/top_nav.html' with class='d-md-flex' %}
    {% include 'shared/nav.html' %}
    <div id="gc-board" v-cloak>

      <div class="header" style="min-height: 200px;">


      </div>
      <header class="container mt-n5 position-relative ">
        <div class="row mb-5">
          <div class="col-12">
            <div class="bg-white rounded d-flex p-3 font-smaller-3">

              <div class="my-3 mx-4 head-number">
                <span class="head-number_title">OPEN BOUNTIES</span>
                <span class="head-number_value">[[ bounties.open ? bounties.open.length : '0' ]]</span>
              </div>
              <div class="my-3 mx-4 head-number">
                <span class="head-number_title">BOUNTY SUBMISSIONS</span>
                <span class="head-number_value">[[ bounties.submitted ? bounties.submitted.length : '0' ]]</span>
              </div>
              <div class="my-3 mx-4 head-number">
                <span class="head-number_title">EXPIRED BOUNTIES</span>
                <span class="head-number_value">[[ bounties.explired ? bounties.explired.length : '0' ]]</span>
              </div>
            </div>
          </div>
        </div>
      </header>
      <section class="container">
        <div class="row">
          <div class="col-12">
            <div class="bg-white rounded border">

              <div class="p-4 border-bottom font-weight-bold" v-if="bounties.open">[[ bounties.open.length ]] Open [[ 'Bount' | pluralize(bounties.open.length, 'y', 'ies') ]]</div>

              <ul class="list-unstyled">
                <li v-for="(bounty, key) in bounties.open" :key="bounty.id" class="position-relative font-smaller-1 mt-3 p-3 border-bottom" :class="isExpanded(key)? 'line-deco': ''">
                  <span class="fa-stack mr-2">
                    <i class="fas fa-circle fa-stack-2x green"></i>
                    <i class="fas fa-user fa-stack-1x fa-inverse"></i>
                  </span>
                  <span class="font-weight-bold">You have [[ bounty.users_count ]] [[ 'applicantion' | pluralize(bounty.users_count) ]] on this bounty</span>
                  <div class="d-flex flex-column flex-lg-row justify-content-between border p-3 my-2 ml-5 rounded">
                    <div class="w-75">
                      <div class="d-flex">
                        <img :src="bounty.avatar_url" alt="" width="40" height="40" class="flex-shrink-0">
                        <div class="d-flex flex-column w-100 ml-3">
                          <a :href="bounty.absolute_url" class="text-truncate mb-2 text-dark">[[ bounty.title ]]</a>
                          <div class="d-flex flex-column flex-md-row justify-content-between">
                            <template v-if="bounty.project_type">
                              <span>[[ bounty.project_type ]]</span> &bull;
                            </template>
                            <template v-if="bounty.expires_date">
                              <span>[[ bounty.expires_date | moment ]]</span> &bull;
                            </template>
                            <span>[[ bounty.value_true ]] [[ bounty.token_name ]] ([[ bounty.value_in_usd ]] USD)</span>
                            <a :href="bounty.absolute_url"><i class="fas fa-eye"></i> View Issue Details</a>
                            <a :href="bounty.github_url" target="_blank"><i class="fab fa-github"></i> View Github</a>
                          </div>
                        </div>
                      </div>
                    </div>
                    <button @click="toggleCollapse(key), fetchApplicants(bounty.id, key, 'open')" class="btn blue">View Applicants <i class="fa fa-fw" :class="isExpanded(key)? 'fa-chevron-up': 'fa-chevron-down'"></i></button>
                  </div>
                  <div v-show="isExpanded(key)">
                    <ul class="list-unstyled m-5">
                      <li class="mb-4" v-for="(contributor, key) in bounty.contributors">
                        <div class="d-flex flex-column flex-md-row justify-content-between">
                          <div class="w-75">
                            <div class="d-flex">
                              <img :src="contributor.avatar_url" alt="" width="40" height="40" class="flex-shrink-0 mr-2 rounded-circle">
                              <div class="d-flex flex-column">
                                <div class="">
                                  <a :href="`/profile/${contributor.handle}`" class="text-dark">[[ contributor.handle ]]</a> <a :href="`https://github.com/${contributor.handle}`" target="_blank"><i class="fab fa-github text-dark"></i></a>
                                </div>
                                <div class="d-flex flex-column flex-lg-row">
                                  <div class="" style="color:#25E899;">
                                    <i class="far fa-star" :class="star <= contributor.star_rating.toFixed() ? 'fas' : 'far'" v-for="star in contributor.star_rating.toFixed(), 5"></i>
                                  </div>
                                    ([[ contributor.total_rating ]] ratings) &bull;
                                    #[[ contributor.leaderboard_rank ]] contributor &bull;
                                    [[ contributor.fulfilled_bounties ]] bounties completed
                                </div>
                              </div>
                            </div>

                          </div>
                          <button class="btn btn-sm btn-gc-blue m-2" @click="startWork(key,bounty.id, contributor.id)" :disabled="key === disabledBtn"><i class="fas fa-check"></i> Accept</button>
                          <button class="btn btn-sm btn-outline-gc-blue m-2" @click="stopWork(key, bounty.id, contributor.id)"><i class="fas fa-times"></i> Reject</button>
                        </div>

                        <div class="comment-plan">[[ contributor.interest.issue_message]]</div>

                      </li>
                      <li class="text-center">
                        <p class="font-smaller-2 blue">Couldn’t find the right contributor?</p>
                        <a href="/users" class="btn btn-outline-gc-blue w-75 font-smaller-2 gc-letter-spacing">EXPLORE USER DIRECTORY</a>
                      </li>
                    </ul>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <section class="container">
        <div class="row">
          <div class="col-12">
            <div class="bg-white rounded border">
              <div class="p-4 border-bottom font-weight-bold">[[bounties.submitted ? bounties.submitted.length : 0  ]] Submitted Bounties</div>

              <ul class="list-unstyled">
                <li v-for="(bounty, key) in bounties.submitted" :key="bounty.id" class="position-relative font-smaller-1 mt-3 p-3 border-bottom" :class="isExpanded(key)? 'line-deco': ''">
                  <span class="fa-stack mr-2">
                    <i class="fas fa-circle fa-stack-2x green"></i>
                    <i class="fas fa-user fa-stack-1x fa-inverse"></i>
                  </span>
                  <span class="font-weight-bold">You have 4 applicantions on this bounty</span>
                  <div class="d-flex flex-column flex-lg-row justify-content-between border p-3 my-2 ml-5 rounded">
                    <div class="w-75">
                      <div class="d-flex">
                        <img :src="bounty.avatar_url" alt="" width="40" height="40" class="flex-shrink-0">
                        <div class="d-flex flex-column w-100 ml-3">
                          <a :href="bounty.url" class="text-truncate mb-2 text-dark">[[ bounty.title ]]</a>
                          <div class="d-flex flex-column flex-md-row justify-content-between">
                            <template v-if="bounty.bounty_type">
                              <span>[[ bounty.bounty_type ]]</span> &bull;
                            </template>
                            <template v-if="bounty.expires_date">
                              <span>[[ bounty.expires_date | moment ]]</span> &bull;
                            </template>
                            <span>[[ bounty.value_true ]] [[ bounty.token_name ]] ([[ bounty.value_in_usdt_now ]] USD)</span>
                            <a :href="bounty.url"><i class="fas fa-eye"></i> View Issue Details</a>
                            <a :href="bounty.github_url" target="_blank"><i class="fab fa-github"></i> View Github</a>
                          </div>
                        </div>
                      </div>
                    </div>
                    <button @click="toggleCollapse(key), fetchApplicants(bounty.id, key, 'open')" class="btn blue">View Applicants <i class="fa fa-fw" :class="isExpanded(key)? 'fa-chevron-up': 'fa-chevron-down'"></i></button>
                  </div>
                  <div v-show="isExpanded(key)">
                    <ul class="list-unstyled m-5">
                      <li class="mb-4" v-for="(contributor, key) in bounty.contributors">
                        <div class="d-flex flex-column flex-md-row justify-content-between">
                          <div class="w-75">
                            <div class="d-flex">
                              <img :src="contributor.avatar_url" alt="" width="40" height="40" class="flex-shrink-0 mr-2 rounded-circle">
                              <div class="d-flex flex-column">
                                <div class="">
                                  <a :href="contributor.url" class="text-dark">[[ contributor.handle ]]</a> <a :href="`https://github.com/${contributor.handle}`" target="_blank"><i class="fab fa-github text-dark"></i></a>
                                </div>
                                <div class="d-flex flex-column flex-lg-row">
                                  <div class="" style="color:#25E899;">
                                    <i class="far fa-star" :class="star <= contributor.star_rating.toFixed() ? 'fas' : 'far'" v-for="star in contributor.star_rating.toFixed(), 5"></i>
                                  </div>
                                    ([[ contributor.total_rating ]] ratings) &bull;
                                    #[[ contributor.leaderboard_rank ]] contributor &bull;
                                    [[ contributor.fulfilled_bounties ]] bounties completed
                                </div>
                              </div>
                            </div>

                          </div>
                          <button class="btn btn-sm btn-gc-blue m-2" @click="startWork(key,bounty.id, contributor.id)" :disabled="key === disabledBtn"><i class="fas fa-check"></i> Accept</button>
                          <button class="btn btn-sm btn-outline-gc-blue m-2" @click="stopWork(key, bounty.id, contributor.id)"><i class="fas fa-times"></i> Reject</button>
                        </div>

                        <div class="comment-plan">[[ contributor.interest.issue_message]]</div>

                      </li>
                      <li class="text-center">
                        <p class="font-smaller-2 blue">Couldn’t find the right contributor?</p>
                        <a href="/users" class="btn btn-outline-gc-blue w-75 font-smaller-2 gc-letter-spacing">EXPLORE USER DIRECTORY</a>
                      </li>
                    </ul>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </section>
    </div>
    {% include 'shared/footer.html' %}
    {% include 'shared/analytics.html' %}
    {% include 'shared/footer_scripts.html' with slim=1 %}
    <script src="{% static "v2/js/board.js" %}"></script>

  </body>
</html>
