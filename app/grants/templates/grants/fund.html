{% comment %}
Copyright (C) 2018 Gitcoin Core

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program. If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}
{% load static humanize i18n %}
<!DOCTYPE html>
<html lang="en">
  <head>
    {% include 'shared/head.html' %}
    {% include 'shared/cards.html' %}
    <link rel="stylesheet" href="{% static "v2/css/grants/fund.css" %}">
  </head>
  <body class="interior {{ active }} grant g-font-muli">
    {% include 'shared/tag_manager_2.html' %}
    <div class="container-fluid header dash">
      {% include 'shared/nav.html' %}
    </div>
    <div class="grant-banner">
      <img src="{% if grant.logo and grant.logo.url %}{{ grant.logo.url }}{% else %}{% static 'v2/images/bitmap.png' %}{% endif %}" width="100%" />
    </div>

    <h2 class="my-5 text-center">
      <div class="mb-2 font-title-lg">{% trans "Fund" %}
        <a href="{{ grant.reference_url }}" target="_blank">
          {{ grant.title }}
        </a>
        {% trans "Grant" %}
      </div>
      <div class="font-subheader admin_profile">
        <a href="{% url 'profile' grant.admin_profile.handle %}">
          {{ grant.admin_profile }}
        </a>
      </div>
    </h2>

    <div class="container">
      <form action='{{ grant.pk }}' method="POST" id="js-fundGrant">
        {% csrf_token %}
        <div class="row">
          <div class="col-12 col-md-10 col-lg-5 order-md-last">
            <div class="grant__progress mt-4">
              <div class="progress">
                <div class="progress-bar" style="width:{{ grant.percent_completed }}%"></div>
              </div>

              <div class="progress-text mt-2">
                <div class="row">
                  <div class="col-6">
                    <span>{{ grant.amount_received }} ETH</span>
                    <p>Current</p>
                  </div>
                  <div class="col-6 text-right">
                    <span>{{ grant.amount_goal }} ETH</span>
                    <p>Goal</p>
                  </div>
                </div>
              </div>
            </div>
            <p class="font-body">
              {{ grant.description }}
            </p>
          </div>

          <div class="col-12 col-md-10 offset-lg-1 col-lg-6">
            <div class="form__group-horizontal">
              <label class="form__label">{% trans "Payment Token" %}</label>
              <div class="row">
                <div class="col-12">
                  <div class="form__select2">
                    <select class='js-select2' name='denomination' id='js-token'> </select>
                  </div>
                </div>
              </div>
            </div>

            <div class="form__group-horizontal">
              <label class="form__label">{% trans "Token Approval Limit" %}</label>
              <div class="row">
                <div class="col-12">
                  <input type="number" name="approve" class="form__input" required />
                </div>
              </div>
            </div>

            <div class="form__group-horizontal">
              <label class="form__label">{% trans "Contribution Per Period" %}</label>
              <div class="row">
                <div class="col-12">
                  <input type="number" name="amount_per_period" class="form__input" required />
                </div>
              </div>
            </div>

            <div class="form__group-horizontal frequency">
              <label class="form__label">{% trans "Frequency of payments" %}</label>
              <div class="row">
                <div class="col-6">
                  <input type="number" id="frequency_count" name="frequency" class="form__input" value='30' required />
                </div>
                <div class="col-6 font-body">
                  <select name="frequency_unit" id="frequency_unit" class="js-select2" style="width: 100%">
                    <option value="minutes">{% trans "minutes" %}</option>
                    <option value="hours">{% trans "hours" %}</option>
                    <option value="days" selected="selected">{% trans "days" %}</option>
                    <option value="months">{% trans "months" %}</option>
                    <option value="any">{% trans "any" %}</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="form__group-horizontal">
              <label class="form__label">{% trans "MetaTx Gas Price" %}</label>
              <div class="row">
                <div class="col-12">
                  <input type="number" name="gas_price" class="form__input" required />
                </div>
              </div>
            </div>

            <div class="form__group-horizontal">
              <div class="row">
                <div class="col-12 form__footer text-center">
                  <button class="button button--primary button--full" id='js-fundGrant'>{% trans "Contribute to Grant" %}</button>
                </div>
              </div>

            </div>
          </div>
        </div>

        <div>
          <input type="hidden" id="grant_id" name="grant_id" value="{{ grant.id }}">
          <input type="hidden" id="admin_address" name="admin_address" value="{{ grant.admin_address }}">
          <input type="hidden" id="token_address" name="token_address" value="{{ grant.token_address }}">
          <input type="hidden" id="contract_address" name="contract_address" value="{{ grant.contract_address }}">
          <input type="hidden" id="network" name="network" value="{{grant.network}}">
          <input type="hidden" id="subscription_hash" name="subscription_hash" value="">
          <input type="hidden" id="signature" name="signature" value="">
          <input type="hidden" id="contributor_address" name="contributor_address" value="">
        </div>
      </form>
    </div>


    {% include 'shared/bottom_notification.html' %}
    {% include 'shared/analytics.html' %}
    {% include 'shared/footer_scripts.html' %}
    {% include 'shared/footer.html' %}
  </body>

  <script src="{% static "v2/js/grants/compiledSubscriptionContract.js" %}"></script>
  <script src="{% static "v2/js/grants/compiledTokenContract.js" %}"></script>
  <script src="/dynamic/js/tokens_dynamic.js"></script>
  <script src="{% static "v2/js/tokens.js" %}"></script>
  <script src="{% static "v2/js/abi.js" %}"></script>
  <script src="{% static "v2/js/pages/shared_bounty_mutation_estimate_gas.js" %}"></script>
  <script src="{% static "v2/js/grants/fund_grant.js" %}"></script>
  <script src="{% static "v2/js/ipfs-api.js" %}"></script>
  <script src="{% static "v2/js/ipfs.js" %}"></script>
</html>
