{% comment %}
Copyright (C) 2020 Gitcoin Core

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program. If not, see <http://www.gnu.org/licenses/>. {% endcomment %} {% load static i18n %} <!DOCTYPE
  html>
  <html lang="en">

  <head>
    {% include 'shared/head.html' with slim=1 %}
    {% include 'shared/cards_pic.html' %}
    <link rel="stylesheet" href="{% static "v2/css/bounty.css" %}">
    <link rel="stylesheet" href="{% static "v2/css/grants/detail.css" %}">
    <link rel="stylesheet" href="{% static "v2/css/grants/fund.css" %}">
    <link rel="stylesheet" href={% static "v2/css/tabs.css" %}>
    <link rel="stylesheet" href={% static "v2/css/dashboard.css" %}>
    <link rel="stylesheet" href={% static "v2/css/tag.css" %}>
    <link rel="stylesheet" href="{% static "v2/css/grants/profile.css" %}">
    <link rel="stylesheet" href="{% static "v2/css/town_square.css" %}">
    <script src="https://cdn.jsdelivr.net/npm/quill@1.3.6/dist/quill.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/quill@1.3.6/dist/quill.snow.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/quill@1.3.6/dist/quill.bubble.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static "v2/css/grants/cart.css" %}">
  </head>

  <body class="interior {{ active }} grant grant-detail g-font-muli">
    {% include 'shared/tag_manager_2.html' %}
    <div class="container-fluid header dash">
      {% include 'shared/top_nav.html' with class='d-md-flex' %}
      {% include 'grants/nav.html' %}
    </div>

    <div>
      <div id="gc-grants-cart" v-cloak>
        <grants-cart ref="cart" inline-template>
          <div>

            <a id="cart_backgrants" class="font-caption ml-2" href="/grants">
              <i class="fas fa-chevron-left mr-1"></i>
              Back to Grants
            </a>

            {% comment %} Heading section {% endcomment %}
            <div class="container" style="margin:3rem auto 1rem;">
              <div class="row align-items-center justify-content-between">
                <div class="col-auto" style="margin:0 auto">
                  <img src="{% static 'v2/images/grants/triangles.png' %}" alt="Triangles" width="150">
                </div>
              </div>

              <div class="row align-items-end justify-content-between" style="margin-top:2rem; width:100%">
                <h1 class="col-auto text-left font-bigger-2 black" style="font-weight: bold; margin-bottom: 0">
                  GRANT CART ([[ grantData.length ]] ITEM<span v-if="grantData.length !== 1">S</span>)
                </h1>
                <div class="col-auto text-right font-smaller-1 hyperlink" style="margin: 2rem 0 0 auto;"
                  @click="confirmClearCart">
                  Clear cart <i class="fa fa-times" aria-hidden="true"></i>
                </div>
                <div class="col-auto text-right font-smaller-1 hyperlink"
                  @click="shareCart">
                  Share cart <i class="fa fa-share-alt" aria-hidden="true"></i>
                </div>
                <div class="col-auto text-right font-smaller-1 hyperlink"
                     @click="showCreateCollection = true">
                  Save as Collection <i class="fas fa-heart"></i>
                </div>
              </div>
            </div>

            {% comment %} Divider {% endcomment %}
            <div>
              <div class="separator"></div>
            </div>

            {% comment %} Main container {% endcomment %}
            <div v-if="grantData.length === 0" class="flex-container font-bigger-1 text-left grant-header-row"
              style="justify-content: center; margin: 5rem 0">
              Your cart is empty.
            </div>

            <div v-else-if="isLoading" style="margin:5rem 0">
              <loading-screen></loading-screen>
              <div style="margin:3rem; text-align:center">Fetching cart data...</div>
            </div>

            <div v-else class="container" style="padding-bottom: 10rem;">
              <div v-if="!isFullyVerified" class="grant-row-style">
                <div class="row align-items-center justify-content-between">
                  <div class="col col-12 col-md-8 col-lg-9">
                    <strong>Get up to 45% greater CLR Match Amount by improving your Trust Bonus</strong> <br />
                    <font size="2">
                      Increase your CLR Match Amount by verifying your profile with various services, and help Gitcoin be more sybil-resistant.
                      Do this anytime before the end of the grants round to earn the match retroactively for all your contributions.
                    </font>
                  </div>
                  <div class="col col-12 col-md-4 col-lg-3 mt-3 mt-md-0 mx-auto text-center">
                    <a href="/{{ username }}/trust" class="button button--primary text-nowrap" role="button" target="_blank">Improve Trust Bonus</a>
                  </div>
                </div>
              </div>
              {% comment %} Cart header {% endcomment %}

              <div>
                <b-tabs @input="tabChange" v-model="tabIndex" content-class="mt-3">
                  <b-tab :title-link-class="'nav-line'">
                    <template v-slot:title><img class="mr-2" src="{% static 'v2/images/chains/ethereum.svg' %}" alt="" height="16"> Ethereum ([[grantsCountByTenant.ETH || 0]])</template>

                    <div class="align-items-center justify-content-between font-smaller-2 text-left grant-header-row d-none d-md-flex">
                      <div class="flex-fill">
                        Grant
                      </div>
                      <div class="flex-fill text-center">
                        Amount
                      </div>
                      <div class="flex-fill text-center">
                        Total CLR Match Amount
                      </div>
                    </div>
                    <div v-for="(grant, index) in grantsByTenant" class="grant-row" :key="grant.grant_id">
                      <div class="grant-row-style">
                        <div class="d-flex align-items-center justify-content-between flex-wrap">
                          {% comment %} Title and logo {% endcomment %}
                          <div class="col-lg-6 d-flex flex-fill">
                              <img :src="grant.grant_logo" style="margin-right: 0.5rem" alt="Grant logo" width="30" height="24">
                              <div class="grant-name black"><a :href="grant.grant_url" target="_blank">[[grant.grant_title]]</a></div>
                          </div>
                          {% comment %} Grant amount and currency {% endcomment %}
                          <div class="d-flex flex-column order-md-0 order-1">
                            <div class="d-flex align-items-center">
                              <input class=" form-control" v-model="grant.grant_donation_amount" type="number" min="0" step="any"
                                placeholder="Amount" style="margin-right: 1rem">
                              <v-select :clearable="false" :reduce="option => option.symbol" append-to-body :options="filterByChainId" placeholder="Select token" label="symbol" v-model="grant.grant_donation_currency" class="flex-shrink-0" style="
                              width: 160px;
                          ">
                                <template v-slot:option="option">
                                  <span class="font-weight-semibold">[[ option.symbol ]]</span>
                                </template>
                              </v-select>

                              <!-- <select2 v-model="grant.grant_donation_currency" class="col-6 form-control"
                                placeholder="Select token">
                                <option v-for="option in currencies[index]" v-bind:value="option" :disabled="!option">
                                  <span v-if="!option" style="height:1px; font-size:1px">&mdash;&mdash;&mdash;&mdash;</span>
                                  <span v-else>[[ option ]]</span>
                                </option>
                              </select2> -->
                            </div>
                            <div class="">
                              <div class="text-left font-smaller-2 hyperlink" @click="applyAmountToAllGrants(grant)">
                                Apply to all
                              </div>
                            </div>
                          </div>
                          {% comment %} CLR Match Amount {% endcomment %}

                          <div class=" align-items-center justify-content-around flex-fill flex-shrink-0 d-flex">
                            <div v-if="grant.is_clr_eligible == true && !grant.is_on_team" class="clr-match-box d-flex flex-nowrap align-items-center">
                              <div class="mr-2">[[grant.grant_donation_clr_match]] DAI</div>
                              <img src="{% static 'v2/images/diamonds_high_fiving.gif' %}" alt="Diamonds high-fiving"
                              width="20">
                            </div>
                            <div v-else-if="grant.is_on_team" class="clr-match-box font-caption font-weight-semibold d-flex flex-nowrap align-items-center">
                              Cannot match own grant
                            </div>
                            <div v-else-if="!grant.clr_round_num" class="clr-match-box font-caption font-weight-semibold d-flex flex-nowrap align-items-center">
                              Not in an active CLR
                            </div>
                            <div v-else class="clr-match-box font-caption font-weight-semibold d-flex flex-nowrap align-items-center">
                              Not Eligible for CLR
                            </div>
                          </div>

                          {% comment %} Delete Icon {% endcomment %}
                          <div class="d-flex">
                            <i class="fas fa-trash-alt" style="cursor: pointer; opacity: 40%"
                              @click="removeGrantFromCart(grant.grant_id)"></i>

                          </div>
                        </div>
                        <div class="form-row font-smaller-3 mt-3" >
                          <div class="comment-option col-auto" >
                            <input v-model="grant.grant_comments" :id="`comment-${grant.grant_id}-blank`" value="" type="radio" class="radio-input" :name="`comment-${grant.grant_id}`"
                                   :checked="grant.grant_comments === ''"
                            >
                            <label :for="`comment-${grant.grant_id}-blank`" class="p-2 px-3 rounded-pill shadow-sm radio-label">+ Add comment to owner</label>
                          </div>
                          <div class="comment-option col-auto">
                            <input v-model="grant.grant_comments" value="üôå Great Job"  :id="`comment-${grant.grant_id}-job`" type="radio" class="radio-input" :name="`comment-${grant.grant_id}`"
                                   :checked="grant.grant_comments === 'üôå Great Job'"
                            >
                            <label :for="`comment-${grant.grant_id}-job`" class="p-2 px-3 rounded-pill shadow-sm radio-label">üôå Great Job</label>
                          </div>
                          <div class="comment-option col-auto">
                            <input v-model="grant.grant_comments" value="üëç i appreciate you" :id="`comment-${grant.grant_id}-appreciate`" type="radio" class="radio-input" :name="`comment-${grant.grant_id}`"
                                   :checked="grant.grant_comments === 'üëç i appreciate you'"
                            >
                            <label :for="`comment-${grant.grant_id}-appreciate`" class="p-2 px-3 rounded-pill shadow-sm radio-label">üëç i appreciate you</label>
                          </div>
                          <div class="comment-option col-auto">
                            <input v-model="grant.grant_comments" value="üí™ keep up the great work" :id="`comment-${grant.grant_id}-work`" type="radio" class="radio-input" :name="`comment-${grant.grant_id}`"
                                   :checked="grant.grant_comments === 'üí™ keep up the great work'"
                            >
                            <label :for="`comment-${grant.grant_id}-work`" class="p-2 px-3 rounded-pill shadow-sm radio-label">üí™ keep up the great work</label>
                          </div>
                          <div class="comment-option col-auto">
                            <input v-model="grant.grant_comments" value="üòç love the mission of your project" :id="`comment-${grant.grant_id}-love`" type="radio" class="radio-input" :name="`comment-${grant.grant_id}`"
                                   :checked="grant.grant_comments === 'üòç love the mission of your project'"
                            >
                            <label :for="`comment-${grant.grant_id}-love`" class="p-2 px-3 rounded-pill shadow-sm radio-label">üòç love the mission of your project</label>
                          </div>
                        </div>
                        <input v-if="grant.grant_comments !== undefined"
                          class="form-control" v-model="grant.grant_comments" type="textarea" placeholder="Enter message">
                      </div>
                    </div>

                    <div class="flex-container font-bigger-1 text-left grant-header-row black" style="font-weight: bold">
                      <div style="width: 25%">
                        <div class="flex-container" style="justify-content: start">
                          TOTAL
                        </div>
                      </div>
                      <div style="width: 75%">
                        <div class="flex-container" style="justify-content: start">
                          [[donationsTotalString]]
                        </div>
                      </div>
                    </div>
                    <hr class="d-sm-none d-md-block" style="height: 1px; background-color: #D8D8D8;" />
                    {% comment %} preferences {% endcomment %}
                    <div class="flex-container font-bigger-1 text-left grant-header-row black"
                      style="font-weight: bold; margin-top: 1rem;">
                      <div style="width: 100%">
                        <div class="flex-container" style="justify-content: start">
                          PREFERENCES
                        </div>
                      </div>
                    </div>
                    {% comment %} Hide wallet option {% endcomment %}
                    <div class="flex-container text-left grant-header-row black m-1 p-1">
                      <div style="width: 100%">
                        <div class="flex-container" style="justify-content: start">
                          <input v-model="hideWalletAddress" type="checkbox" id="hide_wallet_address"
                            style="margin-right:1rem">
                          <label class="font-smaller-1 darker-gray mb-0 pb-0"
                            for="hide_wallet_address">{% trans "Hide my wallet address" %}</label>
                          <span id="hide_wallet_address_help" class="font-smaller-2 medium-dark-gray"
                            style="margin-left: 0.5rem;">
                            {% trans "If this option is chosen, your wallet address will be hidden" %}
                          </span>
                        </div>
                      </div>
                    </div>

                    {% comment %} Anonymize my contribution {% endcomment %}
                    <!-- <div class="flex-container text-left grant-header-row black m-1 p-1">
                      <div style="width: 100%">
                        <div class="flex-container" style="justify-content: start">
                          <input v-model="AnonymizeGrantsContribution" type="checkbox" id="anonymize_gitcoin_grants_contributions"
                            style="margin-right:1rem">
                          <label class="font-smaller-1 darker-gray mb-0 pb-0"
                            for="anonymize_gitcoin_grants_contributions">{% trans "Anonymize my contribution" %}</label>
                          <span id="hide_wallet_address" class="font-smaller-2 medium-dark-gray"
                            style="margin-left: 0.5rem;">
                            {% trans "If this option is chosen, your the contribution will not be attributed to your profile publicly" %}
                          </span>
                        </div>
                      </div>
                    </div> -->

                    {% comment %} Contribution to Gitcoin notice / adjustment {% endcomment %}
                    <div class="flex-container text-left grant-header-row black">
                      <div style="width: 100%">
                        <div class="flex-container" style="justify-content: start">
                          <div id="gitcoin-grant-section" class="form__group-horizontal mt-2">
                            <div class="row">
                              <div class="col-12">
                                <p class="font-body">
                                  {% trans "Contribute to" %} <a
                                    href="https://gitcoin.co/grants/86/gitcoin-sustainability-fund" target="_blank">Gitcoin
                                    Grants Development Fund <i class="fas fa-external-link-alt"></i></a>
                                </p>
                              </div>
                              <!-- changed here -->
                              <div  class="">
                                <div class="d-xl-inline ml-xl-3 mt-4 mt-xl-0">
                                  <div class="btn btn-sm btn-gc-blue font-title font-weight-normal px-4"
                                    :class="{inactive: ![0,5,10,15].includes(gitcoinFactorRaw), 'badge-inactive': gitcoinFactorRaw != 5}"
                                    @click="gitcoinFactorRaw=5">
                                    5%</div>
                                  <div class="btn btn-sm btn-gc-blue font-title font-weight-normal ml-xl-2 px-4"
                                    :class="{inactive: ![0,5,10,15].includes(gitcoinFactorRaw), 'badge-inactive': gitcoinFactorRaw != 10}"
                                    @click="gitcoinFactorRaw=10">
                                    10%</div>
                                  <div class="btn btn-sm btn-gc-blue font-title font-weight-normal ml-xl-2 px-4"
                                    :class="{inactive: ![0,5,10,15].includes(gitcoinFactorRaw), 'badge-inactive': gitcoinFactorRaw != 15}"
                                    @click="gitcoinFactorRaw=15">
                                    15%</div>
                                  <div class="btn btn-sm mx-3 btn-gc-blue font-title font-weight-normal ml-xl-2 px-4"
                                    :class="{inactive: ![0,5,10,15].includes(gitcoinFactorRaw), 'badge-inactive': gitcoinFactorRaw != 0}"
                                    @click="gitcoinFactorRaw=0">
                                    0%</div>
                                  <div class="d-inline-block">
                                    <span class="font-caption md:pl-3">Custom %</span>
                                    <input style="width: 75px;" class="border btn font-title font-weight-normal ml-xl-2 pl-0 text-center mr-2"
                                      type="number" min="0" max="99" step="any" id="gitcoin-grant-input-amount"
                                      name="gitcoin-grant-input-amount" class="form__input text-center"
                                      :class="{inactive: [0,5,10,15].includes(gitcoinFactorRaw)}" value="5"
                                      v-model="gitcoinFactorRaw"
                                    >
                                    {% include './heart.html' %}
                                  </div>
                                </div>
                                <br/>

                                <div class="flex-container text-left grant-header-row black m-1 p-1">
                                  <div class="w-100">
                                    <div class="flex-container" style="justify-content: start">
                                      <input type="checkbox" id="include_for_clr" name="include_for_clr" v-model="include_for_clr" style="margin-right:1rem">
                                      <label class="font-smaller-1 darker-gray mb-0 pb-0" for="include_for_clr">
                                        Include this contribution to CLR matching
                                      </label>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <!-- changed here -->
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    {% comment %} Summary {% endcomment %}
                    <div class="flex-container font-bigger-1 text-left grant-header-row black"
                      style="font-weight: bold; margin-top: 1rem;">
                      <div style="width: 100%">
                        <div class="flex-container" style="justify-content: start">
                          SUMMARY
                        </div>
                      </div>
                    </div>

                    <div class="flex-container text-left cart-section black">
                      <div style="width: 100%">
                        <div class="flex-container" style="justify-content: start">
                          <ul>
                            <li>
                              You are contributing <span style="font-weight: bold">[[donationsToGrantsString]]</span>
                            </li>
                            <li>
                              You are additionally contributing
                              <span style="font-weight: bold">[[donationsToGitcoinString]]</span>
                              to the Gitcoin Maintainer Grant
                            </li>
                            <li>
                              Note: The exact checkout flow will depend on whether you use standard checkout or zkSync.
                              <a href="https://github.com/gitcoinco/web/blob/master/docs/GRANTS.md" target="_blank">
                                Read how this works</a>.
                            </li>
                          </ul>
                        </div>
                      </div>
                    </div>

                    <div class="flex-container" style="margin-top: 3rem;">
                      <div style="width: 100%">
                        <div class="flex-container" style="justify-content: start">
                          <button v-if="!isLoggedIn" class="btn btn-gc-blue button--full shadow-none py-3"
                            id='js-fundGrants-button' @click="loginWithGitHub">
                            <i class="fab fa-github"></i>
                            Login with GitHub to Continue
                          </button>
                          <div v-else>
                            <div class="mb-1">
                              <div v-if="zkSyncUnsupportedTokens.length > 0">
                                zkSync checkout not supported due to [[ zkSyncUnsupportedTokens.join(', ') ]]
                              </div>
                              <div v-else-if="!isNaN(checkoutRecommendation.savingsInPercent)">
                                Save
                                <span class="font-weight-bold text-highlight-green">~[[ checkoutRecommendation.savingsInPercent ]]%</span>
                                on gas costs with [[ checkoutRecommendation.name ]]
                              </div>
                            </div>
                            <div class="row align-items-center justify-content-start">
                              <div v-if="!isZkSyncDown" class="col-auto">
                                {% comment %} HTML Template for cart-ethereum-zksync.js {% endcomment %}
                                <grants-cart-ethereum-zksync
                                  inline-template
                                  @zksync-data-updated="onZkSyncUpdate"
                                  :current-tokens="currentTokens"
                                  :donation-inputs="donationInputs"
                                  :grants-by-tenant="grantsByTenant"
                                  :network="network"
                                >
                                  <div>
                                  {% comment %} Checkout with zkSync button {% endcomment %}
                                    <button
                                      @click="zksync.showModal = true"
                                      class="btn btn-gc-blue button--full shadow-none py-3 mt-1"
                                      :disabled="cart.unsupportedTokens.length > 0 || grantsByTenant.length > cart.maxItems"
                                      id='js-zkSyncfundGrants-button'
                                      v-b-tooltip.hover.top="'zkSync is a scaling solution for Ethereum. It enables extremely low cost transfers of ETH and ERC20 tokens but requires locking funds in layer 2 (cheaper option).'"
                                    >
                                      Checkout with zkSync
                                    </button>

                                    {% comment %} Modal shown when clicking button {% endcomment %}
                                    <b-modal
                                      id="zksync-modal" :visible="zksync.showModal"
                                      @hide="zksync.showModal=false; zksync.showChangeToken=false"
                                      class="modal-dialog modal-lg" header-border-variant="transparent"
                                      center hide-footer no-close-on-backdrop no-close-on-esc hide-header-close
                                    >
                                      {% comment %} Modal close button {% endcomment %}
                                      <template v-slot:modal-header="{ close }">
                                        <button
                                          type="button"
                                          class="close"
                                          data-dismiss="modal"
                                          aria-label="Close"
                                          @click="close()"
                                        >
                                          <span aria-hidden="true">&times;</span>
                                        </button>
                                      </template>

                                      {% comment %} Main content {% endcomment %}
                                      <template v-slot:default="{ hide }">
                                        <div class="px-4 pb-4">
                                          {% comment %} Header {% endcomment %}
                                          <div class="mx-2 mb-4 pb-2 text-center">
                                            <img src="{% static 'v2/images/grants/zksync.svg' %}" alt="zkSync Logo" width="150">
                                            <h1 class="font-bigger-4 font-weight-bold mt-2">Pay with zkSync</h1>
                                          </div>

                                          {% comment %} If checkout not started {% endcomment %}
                                          <div v-if="zksync.checkoutStatus === 'not-started'">
                                            <p>
                                              zkSync is powered by zkRollup with a universal setup &mdash; an L2
                                              scaling solution. Save gas fees and get faster confirmations.
                                              <a href="https://zksync.io/" target="_blank">Learn more</a>.
                                            </p>
                                            <p>Upon clicking Proceed, a new browser tab will be opened for you to finish checkout on zkSync's website.</p>
                                            <div class="font-smaller-2 mb-4">
                                              <p>
                                                zkSync fee amount will be displayed on the zkSync website.
                                                This fee will be paid in <span class="font-weight-bold">[[zksync.feeTokenSymbol]]</span>.
                                                <span v-if="cart.tokenList.length > 1 && !zksync.showChangeToken">
                                                  <span @click="zksync.showChangeToken=true" class="hyperlink">Change token</span>.
                                                </span>
                                              </p>
                                              <div v-if="zksync.showChangeToken">
                                                <div>Select fee token</div>
                                                <v-select v-model="zksync.feeTokenSymbol" :options="cart.tokenList" :clearable="false" style="width: 160px;"/>
                                              </div>
                                            </div>
                                          </div>

                                          {% comment %} If checkout is pending {% endcomment %}
                                          <div v-else-if="zksync.checkoutStatus === 'pending'">
                                            <div class="text-center mb-3" style="font-size:2.5rem">
                                              <i class="fas fa-spinner fa-spin text-highlight-dark-blue"></i>
                                            </div>
                                            <p>Checkout in progress. Please complete the checkout process on the zkSync website.</p>
                                          </div>

                                          {% comment %} Shared warning {% endcomment %}
                                          <div
                                            class="mt-2 p-2 text-left"
                                            style="background-color: #FFF6CF; width: 100%; border: 1px solid rgba(0,0,0,0.1); border-radius: 5px"
                                          >
                                            <div class="font-weight-bold">IMPORTANT: Do not close this tab or the zkSync tab until your transfers are complete!</div>
                                          </div>

                                          {% comment %} If checkout not started {% endcomment %}
                                          <div v-if="zksync.checkoutStatus === 'not-started'" class="text-center pt-4">
                                            <button @click="checkoutWithZksync" class="btn btn-gc-blue shadow-none">
                                            Proceed
                                            </button>
                                            <div class="font-smaller-2 font-italic mt-2">
                                              If the zkSync page does not open, your browser may have blocked it.
                                              Please allow popups from https://gitcoin.co in your browser settings.
                                            </div>
                                          </div>
                                        </div>
                                      </template>

                                    </b-modal>

                                  </div>
                                </grants-cart-ethereum-zksync>
                                {% comment %} End HTML Template for cart-ethereum-zksync.js {% endcomment %}
                                </div>
                              <div class="col-auto">
                                <button v-if="!isZkSyncDown" class="btn btn-outline-gc-blue shadow-none py-3 mt-1" id='js-fundGrants-button' @click="standardCheckout" :disabled="isCheckoutOngoing" v-b-tooltip.hover.top="'Traditional Ethereum easy payout using funds from your connected wallet (easiest option).'">
                                  Standard Checkout
                                </button>
                                <button v-else class="btn btn-gc-blue button--full shadow-none py-3 mt-1" id='js-fundGrants-button' @click="standardCheckout" :disabled="isCheckoutOngoing" v-b-tooltip.hover.top="'Traditional Ethereum easy payout using funds from your connected wallet (easiest option).'">
                                  Standard Checkout
                                </button>
                              </div>
                            </div>
                            <p v-if="isZkSyncDown" class="font-smaller-1 mt-2">
                              zkSync is down at the moment, so if you'd like to checkout now you'll have to use standard checkout!
                            </p>
                            <p v-else-if="grantsByTenant.length > zkSyncMaxCartItems" class="font-smaller-1 mt-2">
                              Must have a maximum of [[zkSyncMaxCartItems]] items in your cart to checkout with zkSync
                            </p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </b-tab>
                  <b-tab :title-link-class="'nav-line'">
                    <template v-slot:title><img class="mr-2" src="{% static 'v2/images/chains/zcash.svg' %}" alt="" height="16"> Zcash ([[grantsCountByTenant.ZCASH || 0]])</template>

                    <div class="align-items-center justify-content-between font-smaller-2 text-left grant-header-row d-none d-md-flex">
                      <div class="flex-fill">
                        Grant
                      </div>
                      <div class="flex-fill text-center">
                        Amount
                      </div>
                      <div class="flex-fill text-center">
                        Total CLR Match Amount
                      </div>
                    </div>
                    <div v-for="(grant, index) in grantsByTenant" class="grant-row" :key="grant.grant_id">
                      <div class="grant-row-style">
                        <div class="d-flex align-items-center justify-content-between flex-wrap">
                          {% comment %} Title and logo {% endcomment %}
                          <div class="col-lg-6 d-flex flex-fill">
                              <img :src="grant.grant_logo" style="margin-right: 0.5rem" alt="Grant logo" width="30" height="24">
                              <div class="grant-name black"><a :href="grant.grant_url" target="_blank">[[grant.grant_title]]</a></div>
                          </div>
                          {% comment %} Grant amount and currency {% endcomment %}
                          <div class="d-flex flex-column order-md-0 order-1">
                            <div class="d-flex align-items-center">
                              <input class=" form-control" v-model="grant.grant_donation_amount" type="number" min="0" step="any"
                                placeholder="Amount" style="margin-right: 1rem">
                              <v-select :clearable="false" :reduce="option => option.symbol" append-to-body :options="filterByChainId" placeholder="Select token" label="symbol" v-model="grant.grant_donation_currency" class="flex-shrink-0" style="
                              width: 160px;
                          ">
                                <template v-slot:option="option">
                                  <span class="font-weight-semibold">[[ option.symbol ]]</span>
                                </template>
                              </v-select>

                              <!-- <select2 v-model="grant.grant_donation_currency" class="col-6 form-control"
                                placeholder="Select token">
                                <option v-for="option in currencies[index]" v-bind:value="option" :disabled="!option">
                                  <span v-if="!option" style="height:1px; font-size:1px">&mdash;&mdash;&mdash;&mdash;</span>
                                  <span v-else>[[ option ]]</span>
                                </option>
                              </select2> -->
                            </div>
                            <!-- <div class="">
                              <div class="text-left font-smaller-2 hyperlink" @click="applyAmountToAllGrants(grant)">
                                Apply to all
                              </div>
                            </div> -->
                          </div>

                          {% comment %} CLR Match Amount {% endcomment %}

                          <div class=" align-items-center justify-content-around flex-fill flex-shrink-0 d-flex">
                            <div v-if="grant.is_clr_eligible == true" class="clr-match-box d-flex flex-nowrap align-items-center">
                              <div class="mr-2">[[grant.grant_donation_clr_match]] USD</div>
                              <img src="{% static 'v2/images/chains/zcash.svg' %}" alt="Diamonds high-fiving"
                              width="20">
                            </div>
                            <div v-else class="clr-match-box font-caption font-weight-semibold d-flex flex-nowrap align-items-center">
                              Not Eligible for CLR
                            </div>
                          </div>
                          <div class=" align-items-center justify-content-around flex-fill flex-shrink-0 d-flex">
                            <b-button v-b-toggle="`collapse-${grant.grant_id}`" class="btn-gc-blue" v-if="!grant.success">
                              Payout
                              <i class="fa fa-fw fa-chevron-up when-open"></i>
                              <i class="fa fa-fw fa-chevron-down when-closed"></i>
                            </b-button>
                            <b-button v-b-toggle="`collapse-${grant.grant_id}`" class="btn-gc-blue" v-else>
                              Completed
                              <i class="fa fa-fw fa-chevron-up when-open"></i>
                              <i class="fa fa-fw fa-chevron-down when-closed"></i>
                            </b-button>
                          </div>
                          {% comment %} Delete Icon {% endcomment %}
                          <div class="d-flex">
                            <i class="fas fa-trash-alt" style="cursor: pointer; opacity: 40%"
                              @click="removeGrantFromCart(grant.grant_id)"></i>

                          </div>
                        </div>
                        <div>
                          <b-collapse :id="`collapse-${grant.grant_id}`">
                            <form action="" ref="form" @submit="confirmZcashPayment($event, grant)">
                              <div class="form-row font-smaller-3 mt-3" >
                                <div class="comment-option col-auto" >
                                  <input v-model="grant.grant_comments" :id="`comment-${grant.grant_id}-blank`" value="" type="radio" class="radio-input" :name="`comment-${grant.grant_id}`"
                                         :checked="grant.grant_comments === ''"
                                  >
                                  <label :for="`comment-${grant.grant_id}-blank`" class="p-2 px-3 rounded-pill shadow-sm radio-label">+ Add comment to owner</label>
                                </div>
                                <div class="comment-option col-auto">
                                  <input v-model="grant.grant_comments" value="üôå Great Job"  :id="`comment-${grant.grant_id}-job`" type="radio" class="radio-input" :name="`comment-${grant.grant_id}`"
                                         :checked="grant.grant_comments === 'üôå Great Job'"
                                  >
                                  <label :for="`comment-${grant.grant_id}-job`" class="p-2 px-3 rounded-pill shadow-sm radio-label">üôå Great Job</label>
                                </div>
                                <div class="comment-option col-auto">
                                  <input v-model="grant.grant_comments" value="üëç i appreciate you" :id="`comment-${grant.grant_id}-appreciate`" type="radio" class="radio-input" :name="`comment-${grant.grant_id}`"
                                         :checked="grant.grant_comments === 'üëç i appreciate you'"
                                  >
                                  <label :for="`comment-${grant.grant_id}-appreciate`" class="p-2 px-3 rounded-pill shadow-sm radio-label">üëç i appreciate you</label>
                                </div>
                                <div class="comment-option col-auto">
                                  <input v-model="grant.grant_comments" value="üí™ keep up the great work" :id="`comment-${grant.grant_id}-work`" type="radio" class="radio-input" :name="`comment-${grant.grant_id}`"
                                         :checked="grant.grant_comments === 'üí™ keep up the great work'"
                                  >
                                  <label :for="`comment-${grant.grant_id}-work`" class="p-2 px-3 rounded-pill shadow-sm radio-label">üí™ keep up the great work</label>
                                </div>
                                <div class="comment-option col-auto">
                                  <input v-model="grant.grant_comments" value="üòç love the mission of your project" :id="`comment-${grant.grant_id}-love`" type="radio" class="radio-input" :name="`comment-${grant.grant_id}`"
                                         :checked="grant.grant_comments === 'üòç love the mission of your project'"
                                  >
                                  <label :for="`comment-${grant.grant_id}-love`" class="p-2 px-3 rounded-pill shadow-sm radio-label">üòç love the mission of your project</label>
                                </div>
                              </div>
                              <input v-if="grant.grant_comments !== undefined"
                                class="form-control" v-model="grant.grant_comments" type="textarea" placeholder="Enter message">
                              <div class="d-flex">
                                <div class="bg-white rounded col mr-2 py-3 d-flex flex-column mt-4">
                                  <p class="font-body"><span class="underline">Step 1</span>: Transfer [[grant.grant_donation_amount]] [[grant.grant_donation_currency]] to the grant owner‚Äôs address below. Make sure you‚Äôre transferring the EXACT SAME AMOUNT shown here or your transaction will not be detected.</p>

                                  <div class="d-flex align-items-center">
                                    <qrcode :string="`zcash:${grant.zcash_payout_address}?amount=${grant.grant_donation_amount}&&message=Thank%20you%20for%20your%20contribution`" :size="100"></qrcode>
                                    <div class="flex-fill font-smaller-1 ml-4">
                                      <div class="d-flex align-items-center">
                                        <span class="mr-2">To:</span>
                                        <div class="">
                                          <span class="font-weight-bold">[[grant.zcash_payout_address]]</span>
                                          <copy-clipboard class="btn btn-sm text-highlight-dark-blue" :string="grant.zcash_payout_address"><i class="far fa-copy"></i></copy-clipboard>
                                        </div>
                                      </div>
                                      <div class="d-flex align-items-center">
                                        <span class="mr-2">Amount:</span>
                                        <div class="font-weight-bold">
                                          [[grant.grant_donation_amount]]
                                        </div>
                                      </div>

                                      <!-- <div class="">transaction id: [[grant.payoutTxId]]</div> -->
                                    </div>
                                  </div>
                                </div>
                                <div class="bg-white rounded col ml-2 py-3 d-flex flex-column mt-4">
                                  <p class="font-body"><span class="underline">Step 2</span>: Choose between <b>t-address</b> or <b>transaction hash</b> and press the confirm button.</p>

                                  <b-form-radio-group id="radio-slots" v-model="selectedZcashPayment" :options="optionsZcashPayment" name="radio-options-slots">
                                  </b-form-radio-group>

                                  <div class="form-row align-items-center mt-3">
                                    <div class="col" v-show="selectedZcashPayment === 'txid'">
                                      <div class="">
                                        <label :for="`payoutTxId_${grant.grant_id}`" class="font-smaller-1">Transaction Hash:</label>
                                        <input v-model="grant.payoutTxId" :name="`payoutTxId_${grant.grant_id}`" :id="`payoutTxId_${grant.grant_id}`" placeholder="00000..." class="form-control form-control-sm" pattern="[a-zA-Z0-9]{64}$" :disabled="grant.success">
                                        <small class="form-text text-muted">Paste the transaction id</small>
                                      </div>
                                    </div>
                                    <div class="col" v-show="selectedZcashPayment === 'taddress'">
                                      <div class="">
                                        <label :for="`contributor_address_${grant.grant_id}`" class="font-smaller-1">Your T-address:</label>
                                        <input v-model="grant.contributor_address" :name="`contributor_address_${grant.grant_id}`" :id="`contributor_address_${grant.grant_id}`" placeholder="t00000..." class="form-control form-control-sm" pattern="^t1[a-zA-Z0-9]{33}$" :disabled="grant.success">
                                        <small class="form-text text-muted">Only t-address are allowed (no z-address support)</small>
                                      </div>
                                    </div>
                                    <div class="mt-2">
                                      <button type="submit" class="btn btn-sm btn-gc-blue" :disabled="(selectedZcashPayment === 'taddress' ? !grant.contributor_address : !grant.payoutTxId ) || grant.loading || grant.success">Confirm</button>
                                    </div>
                                  </div>
                                  <div v-if="grant.error" class="font-body text-danger">[[grant.error]]</div>
                                  <div v-if="grant.success" class="font-body text-success">[[grant.success]]</div>
                                </div>
                              </div>

                            </form>
                          </b-collapse>
                        </div>
                      </div>
                    </div>
                  </b-tab>

                </b-tabs>
              </div>
              {% comment %} Cart total {% endcomment %}


            </div>

          {% comment %} Create Collection Modal {% endcomment %}
            <b-modal id="createCollection" @hide="showCreateCollection = false" :visible="showCreateCollection" center hide-header hide-footer>
              <template v-slot:modal-header="{ close }">
                <button
                  type="button"
                  class="close"
                  data-dismiss="modal"
                  aria-label="Close"
                  @click="showCreateCollection = false"
                >
                  <span aria-hidden="true">&times;</span>
                </button>
              </template>
              <template>
                <div class="mx-5 my-5 ">
                  <div class="mb-3 text-center">
                    <h1 class="mb-5 font-bigger-4 font-weight-bold">Save Cart as Collection</h1>
                  </div>
                  <div class="mb-3">
                    <p class="font-subheader">Collection Name.</p>
                    <b-form-input v-model="collectionTitle" placeholder="What would your collection be called?"></b-form-input>
                  </div>
                  <div class="mb-2">
                    <p class="font-subheader">Description (Optional)</p>
                    <b-form-textarea rows="3" max-rows="6" :state=" collectionDescription.length == 0 ? null : collectionDescription.length < 140" v-model="collectionDescription" placeholder="Short description about your collection"></b-form-textarea>
                    <p class="text-right">[[ collectionDescription.length ]]/140</p>
                  </div>

                  <div class="mb-3" v v-if="collections.length">
                    <h2 class="middle-line mb-3"><span class="text-muted font-body">or</span></h2>
                    <p class="font-subheader mt-3 mb-0">Save to existing collection</p>
                    <b-form-select v-model="selectedCollection" text-field="title" value-field="id" :options="collections" size="md" class="mt-3"></b-form-select>
                  </div>

                  <b-button @click="createCollection()" class="btn-gc-blue mt-2 mb-2" size="lg" :disabled="!isValidCollection">Save Collection</b-button>
                  <br>
                </div>
              </template>
            </b-modal>

          </div>
        </grants-cart>
      </div>
    </div>


    <script type="text/x-template" id="select2-template">
      <select>
        <slot></slot>
      </select>
    </script>

    {% include 'shared/current_profile.html' %}
    {% include 'shared/bottom_notification.html' %}
    {% include 'shared/analytics.html' %}
    {% include 'shared/footer_scripts.html' with ignore_inject_web3=1 %}
    {% include 'shared/footer.html' %}
    {% include 'grants/shared/shared_scripts.html' %}

    {% comment %} ===================== START ZKSYNC SCRIPTS ====================== {% endcomment %}
    <script type="text/javascript" src="https://cdn.ethers.io/lib/ethers-5.0.umd.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/zksync-checkout@0.0.10/dist/main.js"></script>
    {% comment %} ====================== END ZKSYNC SCRIPTS ======================= {% endcomment %}

    <script src="{% static "v2/js/lib/bootstrap-vue.min.js" %}"></script>
    <script>
      document.authenticated = {{ authenticated | yesno:"true,false" }};
      document.isFullyVerified = '{{is_fully_verified}}' === 'True';
    </script>
    <script src="{% static "v2/js/cart-ethereum-zksync.js" %}"></script>
    <script src="{% static "v2/js/cart.js" %}"></script>
  </body>

  {% include 'shared/activity_scripts.html' %}
  <!-- <link rel="stylesheet" href="{% static "v2/css/activity_stream.css" %}"> -->
  <!-- <script src="{% static "v2/js/status.js" %}"></script> -->
  <!-- <script src="{% static "v2/js/pages/tabs.js" %}"></script> -->
  <script src="{% static "v2/js/grants/index.js" %}"></script>
  <script src="{% static "v2/js/abi.js" %}"></script>
  <script src="{% static "v2/js/pages/shared_bounty_mutation_estimate_gas.js" %}"></script>
  <!-- <script src="{% static "v2/js/lib/ipfs-api.js" %}"></script> -->
  <!-- <script src="{% static "v2/js/ipfs.js" %}"></script> -->
  <script src="{% static "v2/js/lib/qrcode.js" %}"></script>
  <script>
    $('[data-toggle="tooltip"]').bootstrapTooltip();

  </script>
  <!-- <script src="{% static "v2/js/user-search.js" %}"></script> -->
  <script src="{% static "v2/js/grants/shared.js" %}"></script>
  <!-- <script src="{% static "v2/js/grants/detail.js" %}"></script> -->
  <!-- <script src="{% static "v2/js/waiting_room_entertainment.js" %}"></script> -->
  <script>
    $('#wallet-address').attr(
      'href',
      get_etherscan_url(
        $('#wallet-address').text().trim(),
        '{{ grant.network }}',
        'address'
      )
    );

  </script>

  </html>
